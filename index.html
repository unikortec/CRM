<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Serra Nobre – Pedidos</title>

  <meta name="theme-color" content="#1e7f46" />
  <meta name="description" content="Pedido rápido com PDF, histórico por cliente e PWA offline." />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png" />

  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <!-- BARRA DE BRAND (verde) -->
  <div class="brandbar"></div>

  <!-- TOPO: Logo + espaço para 'usuário' (placeholder) -->
  <div class="topbar">
    <img src="Serra-Nobre_3.png" alt="Logo Serra Nobre" class="logo-header" onerror="this.style.display='none'">
    <div class="user-slot" title="Espaço reservado para nome do usuário">
      <span id="userDisplayName" class="user-name muted">Usuário</span>
    </div>
  </div>

  <!-- Link “caixa” para Relatórios -->
  <div class="top-actions">
    <a class="pill-link" href="/relatorios.html" title="Abrir Relatórios">Relatórios</a>
  </div>

  <!-- Título alinhado aos campos -->
  <h1 class="page-title">PEDIDOS V1.0.1</h1>

  <main id="appMain">
    <div class="field-group">
      <label for="cliente">Cliente:</label>
      <input list="listaClientes" type="text" id="cliente" autocomplete="off" required />
      <datalist id="listaClientes"></datalist>
    </div>

    <div class="field-group grid-2">
      <div>
        <label for="cnpj">CNPJ:</label>
        <input type="text" id="cnpj" inputmode="numeric" placeholder="00.000.000/0000-00" maxlength="18" />
        <small class="inline-help">Serão salvos apenas dígitos. Validação leve.</small>
      </div>
      <div>
        <label for="ie">Inscrição Estadual:</label>
        <input type="text" id="ie" placeholder="Ex.: ISENTO ou número" />
        <small class="inline-help">Aceita “ISENTO”.</small>
      </div>
    </div>

    <div class="field-group">
      <label for="endereco">Endereço:</label>
      <input type="text" id="endereco" autocomplete="off" required />
      <small class="muted" id="hint-endereco">
        Se for outra cidade, inclua <b>o nome da cidade</b> no fim do endereço.
        Sem cidade, será considerado <b>Porto Alegre - RS</b>.
      </small>
    </div>

    <div class="field-group grid-2">
      <div>
        <label for="contato">Contato (tel/WhatsApp):</label>
        <input type="text" id="contato" inputmode="numeric" placeholder="(00) 00000-0000" maxlength="16" />
      </div>
      <div>
        <label for="cep">CEP:</label>
        <input type="text" id="cep" inputmode="numeric" placeholder="00000-000" maxlength="9" />
      </div>
    </div>

    <div class="field-group">
      <label for="entrega">Data de Entrega:</label>
      <input type="date" id="entrega" required/>
    </div>

    <div class="field-group">
      <label for="horaEntrega">Horário de Entrega:</label>
      <input type="time" id="horaEntrega" required/>
    </div>

    <div class="field-group switch-box">
      <label>Entrega/Retirada:</label>
      <label><input type="radio" name="tipoEntrega" value="ENTREGA" checked> Entrega</label>
      <label><input type="radio" name="tipoEntrega" value="RETIRADA"> Retirada</label>
    </div>

    <div class="field-group">
      <label>Valor do Frete:</label>
      <div class="frete-row">
        <div id="freteValor" class="muted">—</div>
        <label class="inline">
          <input type="checkbox" id="isentarFrete"/> Isentar frete
        </label>
      </div>
    </div>

    <div id="itens"></div>
    <button id="adicionarItemBtn">Adicionar Item</button>

    <hr/>
    <label for="pagamento">Forma de Pagamento:</label>
    <select id="pagamento">
      <option value="PIX">PIX</option>
      <option value="DINHEIRO">DINHEIRO</option>
      <option value="CARTÃO (LEVAR MAQUINA)">CARTÃO (LEVAR MAQUINA)</option>
      <option value="OUTRO">OUTRO</option>
    </select>
    <input type="text" id="pagamentoOutro" placeholder="Digite outra forma de pagamento" style="display:none"/>

    <hr/>
    <label for="obsGeral">Observação geral do pedido:</label>
    <textarea id="obsGeral"></textarea>
    <hr/>

    <button class="pdf-btn"  id="btnGerarPdf">Gerar PDF</button>
    <button class="pdf-btn salvar" id="btnSalvarPdf">Salvar PDF</button>
    <button class="pdf-btn compartilhar" id="btnCompartilharPdf">Compartilhar PDF</button>

    <div id="resumo"></div>
  </main>

  <!-- jsPDF (CDN) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- Módulos do app (ordem importa) -->
  <script type="module" src="js/firebase.js"></script>
  <script type="module" src="js/utils.js"></script>
  <script type="module" src="js/ui.js"></script>
  <script type="module" src="js/clientes.js"></script>
  <script type="module" src="js/itens.js"></script>
  <script type="module" src="js/frete.js"></script>
  <script type="module" src="js/pdf.js"></script>
  <script type="module" src="js/app.js"></script>

  <!-- datalist de produtos -->
  <datalist id="listaProdutos"></datalist>
</body>
</html>
